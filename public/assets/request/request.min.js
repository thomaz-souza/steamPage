var request={run:function(e,t,r,n,i,a){var o=new XMLHttpRequest;return o.open("POST",e,!0),"object"!=typeof t||t instanceof FormData||(t=JSON.stringify(t),o.setRequestHeader("Content-type","text/json")),o.setRequestHeader("X-Requested-With","XMLHttpRequest"),o.setRequestHeader("Transaction-Token",this.tk),this.adm&&o.setRequestHeader("Admin-Token",this.adm),"function"==typeof n&&(o.onprogress=n),"function"==typeof i&&o.upload.addEventListener("progress",i,!1),o.onload="function"==typeof a?a:function(){var e=this.responseText;if(0===o.status)return request.genErr(523,r,o,e);try{e=JSON.parse(e)}catch(t){return console.error(t),request.genErr(500,r,o,e)}r&&r(e,o)},o.send(t),o},genErr:function(e,t,r,n){return t?t({status:e,error:{message:this.errList.genericError,details:n},local:!0},r):void 0},tran:function(e,t,r,n,i,a,o,l){let s=this.validate(r,n);if(!0!==s)throw i&&i(s),s;return this.run(this.u+"/transaction/"+e+"/"+t,n,i,a,o,l)},validate:function(e,t){if("object"!=typeof e)return this.validateError("invalidMap","","");if(0==e.length)return!0;if(t instanceof FormData){let e,r,n={};for(e of t.entries())r=e[0].replace(/\[\]/gi,""),n[r]&&"object"!=typeof n[r]||n[r]&&!n[r].length?n[r]=[n[r],e[1]]:n[r]&&"object"==typeof n[r]?n[r].push(e[1]):n[r]=e[1];t=n}for(i in e){let r=this.avail(t[i],e[i],i);if(!0!==r)return r}return!0},avail:function(e,t,r){return!(!t.ignore||!0!==t.ignore)||(fn=t.name?t.name:r,!t.mandatory||e||t.defaultValue?!t.mandatory&&!e||(t.type&&"file"==t.type?this.availFile(e,t,r):t.type&&typeof e!=t.type?this.validateError("type",fn,r):"object"==typeof e?t.minArrayCount&&e.length<t.minArrayCount?this.validateError("minArrayCount",fn,r):t.maxArrayCount&&e.length>t.maxArrayCount?this.validateError("maxArrayCount",fn,r):!t.map||(v=this.validate(t.map,e),!0===v)||v:!("string"==typeof e&&!t.replaceBefore)||(t.match&&!e.match(t.match)?this.validateError("match",fn,r):t.notMatch&&e.match(t.notMatch)?this.validateError("notMatch",fn,r):t.minLength&&e.length<t.minLength?this.validateError("minLength",fn,r):!(t.maxLength&&e.length>t.maxLength)||this.validateError("maxLength",fn,r))):this.validateError("mandatory",fn,r))},availFile:function(e,t,r){if(t.ignore&&!0===t.ignore)return!0;if(e.length||(e=[e]),fn=t.name?t.name:r,t.mandatory&&0==e.length)return this.validateError("mandatoryFile",fn,r);if(!t.mandatory&&0==e.length)return!0;if(t.mutiple&&!1===t.mutiple&&e.length>1)return this.validateError("multiple",fn,r);if(t.maxMutiple&&e.length>t.maxMutiple)return this.validateError("maxMutiple",fn,r,t.maxMutiple);if(t.minMutiple&&e.length>t.minMutiple)return this.validateError("minMutiple",fn,r,t.minMutiple);for(fs=0,fl=0;fl<e.length;fl++){if(t.maxSize&&e[fl].size>t.maxSize)return this.validateError("maxSize",fn,r,this.fileByte(t.maxSize),e[fl].name);if(t.minSize&&e[fl].size<t.minSize)return this.validateError("minSize",fn,r,this.fileByte(t.minSize),e[fl].name);if(fs+=e[fl].size,t.format&&("object"==typeof t.format&&-1==t.format.indexOf(e[fl].type)||"object"!=typeof t.format&&t.format!=e[fl].type))return this.validateError("format",fn,r,null,e[fl].name);if(x=e[fl].name.match(/\.([^\.]+)$/gi),t.extension&&(!x||!x[0]||"object"==typeof t.extension&&-1==t.extension.indexOf(x[0].replace(".",""))||"object"!=typeof t.extension&&t.extension!=x[0].replace(".","")))return this.validateError("extension",fn,r,null,e[fl].name)}return t.maxSizeAll&&fs>t.maxSizeAll?this.validateError("maxSizeAll",fn,r,this.fileByte(t.maxSizeAll)):!(t.minSizeAll&&fs<t.minSizeAll)||this.validateError("minSizeAll",fn,r,this.fileByte(t.minSizeAll))},fileByte:function(e){if(0===e)return"0B";const t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+["B","KB","MB","GB","TB","PB","EB","ZB","YB"][t]},validateError:function(e,t,r,n,i){return ms=this.errList[e].replace("%s",n||t),{error:{message:ms,code:e,details:{details:r,object:t,file:i}},local:!0,status:400}},parseForm:function(e,t,r,n,i,a){event&&event.preventDefault();let o=new FormData;for(let t=0;t<e.elements.length;t++)if(el=e.elements[t],"file"!=el.type)if("checkbox"!=el.type&&"radio"!=el.type)if("select-multiple"==el.type||"select"==el.type&&el.getAttribute("multiple"))for(let e=0;e<el.options.length;e++)opt=el.options[e],opt.selected&&o.append(el.name,opt.value||opt.text);else o.append(el.name,el.value);else el.checked&&o.append(el.name,el.value),el.checked||(u=el.getAttribute("data-value-unchecked"),"string"==typeof u&&o.append(el.name,u));else for(let e=0;e<el.files.length;e++)o.append(el.name,el.files[e],el.files[e].name);if(r)r(o,t,n,i,a);else{if(!t||"function"!=typeof t)return o;t(o)}return!1},checkResponse:function(e){return 200==e.status||(e.error&&e.error.details&&e.error.details.object&&this.showError(e.error.details.object,e.error.message),!1)},showError:function(e,t,r){let n=$('[name="'+e+'"]');n.addClass("input-error"),t&&n.parent().append('<p class="input-error-msg">'+t+"</p>");let i=this,a=function(){i.clearError(e)};n.on("input",a),n.on("change",a),(!1!==r&&window.innerWidth<1e3||!0===r)&&$([document.documentElement,document.body]).animate({scrollTop:n.offset().top-200},500)},clearError:function(e){if(e){let t=$('[name="'+e+'"]');return t.removeClass("input-error"),t.parent().find(".input-error-msg").remove()}$(".input-error").removeClass("input-error"),$(".input-error-msg").remove()},formatURL:function(e){return request.u?request.u+"/"+e.replace(/^\~/gi,"").replace(/^\//gi,"").replace(/[\/]{2,}/gi,"/"):(console.error("You must include a controller to use this resource"),e)},require:function(e){let t,r=/\.(js|css)([\?]{1}[\s\S]+?){0,}$/gi.exec(e);if(!r)return console.error("Invalid file to include");"js"==r[1]?(t=document.createElement("script"),t.src=e):"css"==r[1]&&(t=document.createElement("link"),t.rel="stylesheet",t.href=e),document.head.append(t)},requirePublic:function(e){let t=request.formatURL("public/"+e);return request.require(t)},requireAsset:function(e){return request.requirePublic("assets/"+e)},TM:function(e,t,r){var n=this;n.url=function(){return request.u+"/transaction/"+e+"/"+t},n.method=function(){return e},n.function=function(){return t},n.map=function(){return r},n.call=function(n,i,a,o,l){return request.transaction(e,t,r,n,i,a,o,l)},n.validate=function(e){return request.validate(r,e)}}};
